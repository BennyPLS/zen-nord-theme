:root {
    /* Theming Variables */

    /* Accent Color Variations Based on Theme Setting */

    body:has(#theme-nord[theme-nord-accent="red"]) {
        --accent-color: #bf616a !important;
    }

    body:has(#theme-nord[theme-nord-accent="orange"]) {
        --accent-color: #d08770 !important;
    }

    body:has(#theme-nord[theme-nord-accent="yellow"]) {
        --accent-color: #ebcb8b !important;
    }

    body:has(#theme-nord[theme-nord-accent="green"]) {
        --accent-color: #a3be8c !important;
    }

    body:has(#theme-nord[theme-nord-accent="purple"]) {
        --accent-color: #b48ead !important;
    }

    body:has(#theme-nord[theme-nord-accent="frost"]) {
        --accent-color: #88c0d0 !important;
    }

    --zen-colors-primary: var(--accent-color) !important;

    --zen-colors-secondary: #3B4252 !important;
    --zen-colors-tertiary: #2E3440 !important;

    @media (-moz-bool-pref: "theme.nord.borders") {
        --zen-colors-border: var(--accent-color) !important;
    }

    --zen-colors-border: #4c566a !important;

    --zen-primary-color: var(--accent-color) !important;

    /* Base Color Variables */
    @media (-moz-bool-pref: "theme.nord.background.darker") {
        --zen-dark-color-mix-base: #2E3440 !important; /* nord0 */
    }
    --zen-dark-color-mix-base: #3b4252 !important; /* nord0 */
    --zen-colors-primary-foreground: #D8DEE9 !important; /* nord4 */

    /* Background Colors */
    --zen-main-browser-background: var(--zen-dark-color-mix-base) !important;
    --zen-in-content-dialog-background: var(--zen-dark-color-mix-base) !important;
    --zen-urlbar-background: var(--zen-dark-color-mix-base) !important;
    --in-content-page-background: var(--zen-dark-color-mix-base) !important;
    --in-content-box-background: var(--zen-dark-color-mix-base) !important;
    --in-content-table-background: var(--zen-dark-color-mix-base) !important;
    --card-background-color: #3B4252 !important; /* nord1 */
    --in-content-button-background: #4C566A !important; /* nord3 */

    /* Hover, Input, and Interactive States */
    --zen-colors-hover-bg: color-mix(in srgb, var(--zen-primary-color) 70%, var(--zen-dark-color-mix-base) 30%) !important;
    --zen-colors-input-bg: var(--zen-dark-color-mix-base) !important;
    --zen-input-border-color: var(--zen-colors-border) !important;

    /* Active/Selected States */
    --toolbarbutton-active-background: var(--zen-colors-primary) !important;
    --zen-browser-gradient-base: var(--zen-colors-secondary) !important;
    --in-content-primary-button-text-color: var(--zen-dark-color-mix-base) !important;

    /* Secondary UI Elements */
    --toolbarbutton-icon-fill-attention: var(--in-content-primary-button-background) !important;
    --zen-settings-secondary-background: var(--zen-dark-color-mix-base) !important;
    --in-content-box-info-background: var(--zen-dark-color-mix-base) !important;

    /* New Tab Page */
    --newtab-background-color: var(--zen-dark-color-mix-base) !important;
    --newtab-background-color-secondary: #3B4252 !important; /* nord1 */
    --newtab-text-primary-color: var(--zen-colors-primary-foreground) !important;
}

/* Fix Find bar */
.browserContainer > findbar {
    background: var(--zen-dark-color-mix-base);
}

/* Fix double border on browser container */
.browserContainer {
    background: transparent !important;
}

/* Tab colors */
.tabbrowser-tab[pinned] .tab-stack .tab-background {
    background: color-mix(in srgb, var(--accent-color) 30%, transparent 30%) !important;
}

.tabbrowser-tab[pinned][selected="true"] .tab-stack .tab-background,
label.tabbrowser-tab[pinned][multiselected="true"] .tab-stack .tab-background {
    background-color: var(--zen-colors-primary) !important;
}

.tabbrowser-tab[selected=true] .tab-stack .tab-background {
    background-color: var(--zen-colors-primary) !important;
}

.tabbrowser-tab:hover .tab-stack .tab-background {
    background-color: color-mix(in srgb, var(--accent-color) 70%, transparent 50%) !important;
}

.tabbrowser-tab .tab-stack .tab-background {
    border: var(--zen-colors-border) 1px !important;
}


/* Search bar left boxes */
#identity-box box, #identity-icon-box {
    background-color: var(--accent-color) !important;
}

/* Browser and Settings Pages */
@-moz-document url-prefix(about:), url-prefix(chrome:), url(https://www.mozilla.org/credits/) {
    html, body, #mount {
        background-color: var(--zen-dark-color-mix-base) !important;
    }

    :where(groupbox) button, .default-button {
        background-color: var(--zen-main-browser-background) !important;
    }

    .navigation, .moz-card, groupbox {
        background-color: #3B4252 !important; /* nord1 */
    }
}

@media (-moz-bool-pref: "theme.nord.tabs.icons") {
    .tabbrowser-tab {
        .tab-icon-stack {
            background: var(--accent-color) !important;
            width: fit-content !important;
            padding: calc(var(--toolbarbutton-inner-padding) / 2) !important;
            border-radius: 200px !important;

            margin-right: var(--toolbarbutton-inner-padding) !important;
            margin-left: calc(var(--toolbarbutton-inner-padding) / 4) !important;
        }

        .tab-icon-image {
            margin-inline: 0 !important;
        }
    }

    /* fix tabs when nav bar is */
    .tabbrowser-tab[pinned] .tab-content {
        padding: 0 !important;

        .tab-icon-stack {
            margin-inline: 0 !important;
        }
    }

    /* fix tabs when nav bar is collapsed */
    @media (-moz-bool-pref: "zen.tabs.vertical") {
        #navigator-toolbox:not(#navigator-toolbox:is(#navigator-toolbox[zen-user-hover="true"][zen-has-hover], #navigator-toolbox[zen-user-hover="true"]:focus-within, #navigator-toolbox[zen-user-hover="true"][movingtab], #navigator-toolbox[zen-user-hover="true"][flash-popup], #navigator-toolbox[zen-user-hover="true"][has-popup-menu], #navigator-toolbox[zen-user-hover="true"]:has([open="true"]:not(tab):not(#zen-sidepanel-button)), #navigator-toolbox[zen-expanded="true"]:not([zen-user-hover="true"]))) {
            & #tabbrowser-tabs {
                & .tabbrowser-tab {
                    & .tab-icon-stack {
                        margin-inline: 0 !important;
                    }
                }
            }
        }
    }
}